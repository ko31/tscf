!function(t){"use strict";var e=function(t){t.datetimepicker({dateFormat:t.attr("data-date-format"),timeFormat:t.attr("data-time-format"),separator:t.attr("data-separator"),changeYear:!0,changeMonth:!0})},a=function(t){t.datepicker({dateFormat:t.attr("data-date-format"),changeYear:!0,changeMonth:!0})},i=function(e){var a=parseInt(e.attr("data-limit"),10),i=e.attr("data-post-type"),c={minimumInputLength:1,placeholder:"",allowClear:!0,ajax:{url:TSCF.root+"/posts",dataType:"json",delay:250,data:function(t){return{q:t.term,post_type:i,_wpnonce:TSCF.nonce}},processResults:function(t,e){return{results:t.posts}},cache:!0}};0<a&&(c.maximumSelectionLength=a),e.select2(c),e.change(function(e){var a=t(this).val();null===a?a="":"string"!=typeof a&&(a=a.join(",")),t(this).prev("input").val(a)})},c=function(t){var e=t.attr("data-language"),a=t.attr("data-theme"),i=ace.edit(t.next(".tscf__ace").get(0));i.setTheme("ace/theme/"+a),i.getSession().setMode("ace/mode/"+e),i.setOptions({maxLines:500});var c=function(){t.val(i.getValue())},n=null;i.getSession().on("change",function(t){n&&clearTimeout(n),n=setTimeout(c,1e3)})};t(document).ready(function(){t(".tscf__datetimepicker").each(function(a,i){e(t(i))}),t(".tscf__datepicker").each(function(e,i){a(t(i))}),t(".tscf__input--token").each(function(e,a){i(t(a))}),t(".tscf__input--ace").each(function(e,a){c(t(a))}),t(".tscf--iterator").on("created.tscf",".tscf__child",function(){var n;t.each([["datetimepicker",e],["datepicker",a],["input--token",i],["input--ace",c]],function(e,a){(n=t(this).find(t(".tscf__"+a[0])).selector)&&n.length&&n.each(function(e,i){a[1](t(i))})})})}),t(document).ready(function(){var e,a,i;function c(e){var a=[];e.find("img").each(function(e,i){a.push(t(i).attr("data-image-id"))}),e.prev("input[type=hidden]").val(a.join(",")),e.effect("highlight",{},1e3)}function n(e){var a=[];e.find("video").each(function(e,i){a.push(t(i).attr("data-video-id"))}),e.prev("input[type=hidden]").val(a.join(",")),e.effect("highlight",{},1e3)}t(".tscf").on("click",".tscf__image--add",function(a){a.preventDefault(),(i=t(this).prev(".tscf__placeholder")).find("img").length>=parseInt(i.attr("data-limit"),10)||(e||(e=wp.media({className:"media-frame tscf__imageEditor",frame:"select",multiple:!0,title:t(this).text(),library:{type:"image"},button:{text:TSCF.select}})).on("select",function(){var a=i.find("img").length,n=parseInt(i.attr("data-limit"),10)-a,r=0;e.state().get("selection").each(function(e){if(r<n){var a,c=e.toJSON();a=c.sizes.thumbnail?c.sizes.thumbnail.url:c.sizes.full.url;var s=t('<div class="tscf__image"><img data-image-id="'+c.id+'" class="tscf__image--object" src="'+a+'" /><a class="button tscf__image--delete" href="#">'+TSCF.delete+"</a></div>");i.find(".tscf__placeholder--limit").before(s)}r++}),c(i)}),e.open())}).on("click",".tscf__image--delete",function(e){e.preventDefault();var a=t(this).parents(".tscf__placeholder");t(this).parents(".tscf__image").remove(),c(a)}),t(".tscf").on("click",".tscf__video--add",function(e){e.preventDefault(),(i=t(this).prev(".tscf__placeholder")).find("video").length>=parseInt(i.attr("data-limit"),10)||(a||(a=wp.media({className:"media-frame tscf__videoEditor",frame:"select",multiple:!0,title:t(this).text(),library:{type:"video"},button:{text:TSCF.select}})).on("select",function(){var e=i.find("video").length,c=parseInt(i.attr("data-limit"),10)-e,r=0;a.state().get("selection").each(function(e){if(r<c){var a,n=e.toJSON();a=n.url;var s=t('<div class="tscf__video"><video data-video-id="'+n.id+'" class="tscf__video--object" src="'+a+'" /><a class="button tscf__video--delete" href="#">'+TSCF.delete+"</a></div>");i.find(".tscf__placeholder--limit").before(s)}r++}),n(i)}),a.open())}).on("click",".tscf__video--delete",function(e){e.preventDefault();var a=t(this).parents(".tscf__placeholder");t(this).parents(".tscf__video").remove(),n(a)})}),t(document).ready(function(){var e,a,i=function(e){t(e).parents(".tscf__url--wrapper").find(".tscf-preview-button").attr("href",t(e).val())};t(".tscf").on("click",".tscf-select-button",function(i){i.preventDefault(),a=t(this).parents(".tscf__url--wrapper").find(".tscf__input--url"),e||(e=wp.media({className:"media-frame tscf__fileSelector",frame:"select",multiple:!1,title:"",button:{text:TSCF.select}})).on("select",function(){e.state().get("selection").each(function(t){a.val(t.get("url")),a.trigger("change")})}),e.open()}).on("change keyup",".tscf__input--url",function(){i(this)}),t(".tscf__input--url").each(function(t,e){i(e)}),t(".tscf-preview-button").livePreview({trigger:"click",viewWidth:400,viewHeight:300,targetWidth:1200,targetHeight:900,scale:"0.3333",offset:50,position:"left"})}),t(".tscf--iterator").on("click",".tscf__add",function(e){e.preventDefault();var a=t(this).parents(".tscf--iterator"),i=parseInt(a.attr("data-max"),10),c=a.find(".tscf__template");if(!i||a.find(".tscf__child").length<i){var n=t(c.html());n.appendTo(a.find(".tscf__childList")),a.trigger("compute.tscf"),n.trigger("created.tscf")}}),t(".tscf--iterator").on("click",".tscf__button",function(e){if(e.preventDefault(),t(this).hasClass("tscf__button--delete")){var a=t(this).parents(".tscf--iterator");t(this).parents(".tscf__child").remove(),a.trigger("compute.tscf")}}),t(".tscf__childList").sortable({axis:"y",handle:".tscf__button--move",placeholder:"tscf__child--placeholder",update:function(t,e){e.item.parents(".tscf--iterator").trigger("compute.tscf")}}),t(".tscf--iterator").on("compute.tscf",function(e,a){var i=t(this).attr("data-prefix"),c=0;a||t(this).effect("highlight",{},500),t(this).find(".tscf__child").each(function(e,a){c++,t.each(["id","for","name"],function(c,n){t(a).find("["+n+"^="+i+"_]").each(function(a,i){t(i).attr(n,t(i).attr(n).replace(/_[0-9]+(\[?)/,function(){return"_"+(e+1)+arguments[1]}))})})}),t(this).find(".tscf__index").val(c)}),t(document).ready(function(){t(".tscf--iterator").trigger("compute.tscf",[!0])})}(jQuery);
//# sourceMappingURL=map/tscf-helper.js.map
